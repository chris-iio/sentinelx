---
phase: 12-shared-component-elevation
plan: "03"
type: execute
wave: 3
depends_on:
  - "12-01"
  - "12-02"
files_modified:
  - app/templates/macros/icons.html
  - app/templates/base.html
  - app/static/src/input.css
  - app/static/dist/style.css
autonomous: false
requirements:
  - COMP-06
  - COMP-07

must_haves:
  truths:
    - "A Jinja2 icon macro at templates/macros/icons.html provides inline SVG icons via {{ icon('name') }} syntax"
    - "Header brand name uses Inter Variable with emerald accent color on 'Sentinel' and normal weight on 'X'"
    - "Footer text is updated from Phase 1 placeholder to current product description"
    - "Header and footer render correctly in the browser with icon macro imports working"
  artifacts:
    - path: "app/templates/macros/icons.html"
      provides: "Jinja2 icon macro with shield-check and cog-6-tooth Heroicons"
      contains: "macro icon"
    - path: "app/templates/base.html"
      provides: "Updated header/footer with icon macro import and emerald brand accent"
      contains: "from \"macros/icons.html\" import icon"
    - path: "app/static/src/input.css"
      provides: "Updated .site-logo CSS for Inter Variable"
      contains: ".brand-accent"
  key_links:
    - from: "app/templates/base.html"
      to: "app/templates/macros/icons.html"
      via: "{% from 'macros/icons.html' import icon %}"
      pattern: "from.*macros/icons.html.*import.*icon"
    - from: "app/templates/base.html .site-logo"
      to: "app/static/src/input.css .brand-accent"
      via: "CSS class on brand name span"
      pattern: "brand-accent"
---

<objective>
Create the Heroicons Jinja2 macro system and redesign the header/footer with updated typography and emerald accent treatment.

Purpose: COMP-06 establishes the icon infrastructure that Phase 13 and 14 will build on (magnifying glass for search, shield for empty state). COMP-07 updates the header/footer from the Phase 1 placeholder state to the target design system, using Inter Variable typography and emerald accent on the brand name.

Output: New `macros/icons.html` file, updated `base.html` template, updated header/footer CSS in `input.css`.
</objective>

<execution_context>
@/home/chris/.claude/get-shit-done/workflows/execute-plan.md
@/home/chris/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/12-shared-component-elevation/12-RESEARCH.md
@.planning/phases/12-shared-component-elevation/12-01-SUMMARY.md
@.planning/phases/12-shared-component-elevation/12-02-SUMMARY.md

<interfaces>
<!-- From app/templates/base.html — current header structure -->
<header class="site-header">
    <div class="header-inner">
        <img src="{{ url_for('static', filename='images/logo.svg') }}" alt="" class="site-logo-icon" width="28" height="28">
        <span class="site-logo">SentinelX</span>
        <span class="site-tagline">Offline IOC Extractor</span>
        <nav class="site-nav">
            <a href="{{ url_for('main.settings_get') }}" class="nav-link">Settings</a>
        </nav>
    </div>
</header>
<!-- Footer: <p>SentinelX — Phase 1 Offline Pipeline</p> -->

<!-- From input.css — current header/footer CSS -->
.site-logo {
    font-family: var(--font-mono);  /* CHANGE to var(--font-ui) */
    font-size: 1.1rem;
    font-weight: 700;
    color: var(--text-primary);
    letter-spacing: -0.02em;
}
.site-tagline { font-size: 0.8rem; color: var(--text-secondary); }
.site-nav .nav-link { color: var(--text-secondary); font-size: 0.85rem; transition: color 0.15s ease; }
.site-footer { bg: var(--bg-secondary); border-top; padding; text-align: center; font-size: 0.75rem; color: var(--text-secondary); }

<!-- Heroicons v2 SVG paths from research — these must be copied exactly -->
<!-- shield-check (24px solid): confirmed path from heroicons.com -->
<!-- cog-6-tooth (24px solid): confirmed path from heroicons.com -->
</interfaces>
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Heroicons Jinja2 macro and update header/footer (COMP-06 + COMP-07)</name>
  <files>
    app/templates/macros/icons.html
    app/templates/base.html
    app/static/src/input.css
    app/static/dist/style.css
  </files>
  <action>
**Step 1: Create icon macro file**

Create the directory `app/templates/macros/` if it does not exist, then create `app/templates/macros/icons.html`:

```jinja2
{# Heroicons v2 — inline SVG via Jinja2 macro
   Icons are 24x24 solid variants from heroicons.com.
   Usage: {{ icon("shield-check", class="w-5 h-5") }}
#}
{% macro icon(name, class="w-4 h-4", aria_label=none) -%}
<svg xmlns="http://www.w3.org/2000/svg"
     viewBox="0 0 24 24"
     fill="currentColor"
     class="{{ class }}"
     {% if aria_label %}aria-label="{{ aria_label }}"{% else %}aria-hidden="true"{% endif %}
>
  {% if name == "shield-check" %}
  <path fill-rule="evenodd" d="M12.516 2.17a.75.75 0 0 0-1.032 0 11.209 11.209 0 0 1-7.877 3.08.75.75 0 0 0-.722.515A12.74 12.74 0 0 0 2.25 9.75c0 5.942 4.064 10.933 9.563 12.348a.749.749 0 0 0 .374 0c5.499-1.415 9.563-6.406 9.563-12.348 0-1.39-.223-2.73-.635-3.985a.75.75 0 0 0-.722-.516l-.143.001c-2.996 0-5.717-1.17-7.734-3.08Zm3.094 8.016a.75.75 0 1 0-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 0 0-1.06 1.06l2.25 2.25a.75.75 0 0 0 1.14-.094l3.75-5.25Z" clip-rule="evenodd"/>
  {% elif name == "cog-6-tooth" %}
  <path fill-rule="evenodd" d="M11.078 2.25c-.917 0-1.699.663-1.85 1.567L9.05 4.889c-.02.12-.115.26-.297.348a7.493 7.493 0 0 0-.986.57c-.166.115-.334.126-.45.083L6.3 5.508a1.875 1.875 0 0 0-2.282.819l-.922 1.597a1.875 1.875 0 0 0 .432 2.385l.84.692c.095.078.17.229.154.43a7.598 7.598 0 0 0 0 1.139c.015.2-.059.352-.153.43l-.841.692a1.875 1.875 0 0 0-.432 2.385l.922 1.597a1.875 1.875 0 0 0 2.282.818l1.019-.382c.115-.043.283-.031.45.082.312.214.641.405.985.57.182.088.277.228.297.35l.178 1.071c.151.904.933 1.567 1.85 1.567h1.844c.916 0 1.699-.663 1.85-1.567l.178-1.072c.02-.12.114-.26.297-.349.344-.165.673-.356.985-.57.167-.114.335-.125.45-.082l1.02.382a1.875 1.875 0 0 0 2.28-.819l.923-1.597a1.875 1.875 0 0 0-.432-2.385l-.84-.692c-.095-.078-.17-.229-.154-.43a7.614 7.614 0 0 0 0-1.139c-.016-.2.059-.352.153-.43l.84-.692c.708-.582.891-1.59.433-2.385l-.922-1.597a1.875 1.875 0 0 0-2.282-.818l-1.02.382c-.114.043-.282.031-.449-.083a7.49 7.49 0 0 0-.985-.57c-.183-.087-.277-.227-.297-.348l-.179-1.072a1.875 1.875 0 0 0-1.85-1.567h-1.843ZM12 15.75a3.75 3.75 0 1 0 0-7.5 3.75 3.75 0 0 0 0 7.5Z" clip-rule="evenodd"/>
  {% endif %}
</svg>
{%- endmacro %}
```

IMPORTANT: The SVG paths above are from Heroicons v2 (24px solid variants). Do NOT modify these paths — they are complex bezier curves that produce the correct icon shapes.

**Step 2: Update base.html**

Add icon macro import at the top of `base.html` (after `<html>` or before `<head>`— Jinja2 imports can go at the very top of the file):

```jinja2
{% from "macros/icons.html" import icon %}
```

Update the header section:
- Change brand name from `<span class="site-logo">SentinelX</span>` to:
  ```html
  <span class="site-logo"><span class="brand-accent">Sentinel</span>X</span>
  ```
- Update the tagline from "Offline IOC Extractor" to "IOC Triage Tool" (reflects current functionality — tool supports both offline and online modes)
- Add a cog icon before "Settings" in the nav link:
  ```html
  <a href="{{ url_for('main.settings_get') }}" class="nav-link">{{ icon("cog-6-tooth", class="nav-icon") }} Settings</a>
  ```

Update the footer:
- Change `<p>SentinelX — Phase 1 Offline Pipeline</p>` to `<p>SentinelX — IOC Triage Tool</p>`

**Step 3: Update CSS in input.css**

Modify `.site-logo` (around line 151-157):
- Change `font-family: var(--font-mono)` to `font-family: var(--font-ui)`
- Change `font-weight: 700` to `font-weight: var(--weight-heading)` (600)

Add `.brand-accent` class after `.site-logo`:
```css
.brand-accent {
    color: var(--accent);
}
```

Add `.nav-icon` class after `.site-nav .nav-link:hover`:
```css
.nav-icon {
    width: 16px;
    height: 16px;
    display: inline-block;
    vertical-align: -3px;
    margin-right: 4px;
}
```

Update `.site-nav` to push nav to the right (add `margin-left: auto` if not already present):
```css
.site-nav {
    margin-left: auto;
}
```

Update `.site-footer` to explicitly set `font-family: var(--font-ui)`:
```css
.site-footer {
    /* ... existing properties ... */
    font-family: var(--font-ui);
}
```

Run `make css` after all CSS changes.

**Step 4: Verify Flask renders correctly**

Run the unit test suite to confirm no template errors:
```bash
pytest tests/ --ignore=tests/e2e -x -q
```

Any `TemplateNotFound` error means the macro import path is wrong — it must be `"macros/icons.html"` (relative to templates root), NOT `"./macros/icons.html"` or `"templates/macros/icons.html"`.
  </action>
  <verify>
    <automated>cd /home/chris/projects/sentinelx && test -f app/templates/macros/icons.html && grep -q 'from "macros/icons.html" import icon' app/templates/base.html && grep -q 'brand-accent' app/templates/base.html && grep -q 'brand-accent' app/static/src/input.css && make css 2>&1 | tail -1 && pytest tests/ --ignore=tests/e2e -x -q 2>&1 | tail -3</automated>
  </verify>
  <done>
- `app/templates/macros/icons.html` exists with shield-check and cog-6-tooth icon macros
- `base.html` imports the icon macro, has emerald brand accent on "Sentinel", updated tagline and footer text
- `.site-logo` uses `var(--font-ui)` instead of `var(--font-mono)`
- `.brand-accent` CSS class applies `var(--accent)` color
- `make css` succeeds
- All unit/integration tests pass (no TemplateNotFound errors)
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 2: Visual verification of all Phase 12 components</name>
  <files>none — visual verification only</files>
  <action>
CHECKPOINT: Human visual verification of all Phase 12 shared component elevation work.

What was built:
- COMP-01: Verdict badges unified with tinted-bg + colored-border + colored-text (both badge systems)
- COMP-02: Focus rings standardized to 2px teal outline on :focus-visible
- COMP-03: Ghost button variant added alongside primary and secondary
- COMP-04: .form-input class for dark-theme form elements
- COMP-05: Frosted-glass filter bar backdrop
- COMP-06: Heroicons Jinja2 macro
- COMP-07: Header/footer with Inter Variable + emerald brand accent

How to verify — start the Flask dev server: `flask run`

**1. Header/Footer (COMP-06, COMP-07):**
- Visit any page — verify the header shows "SentinelX" with "Sentinel" in emerald green
- Verify the tagline says "IOC Triage Tool" (not "Offline IOC Extractor" or "Phase 1")
- Verify a small cog icon appears before "Settings" in the nav
- Verify the footer says "SentinelX — IOC Triage Tool"
- Verify the brand name is in Inter Variable (sans-serif), not JetBrains Mono (monospace)

**2. Focus Rings (COMP-02):**
- On the input page, press Tab to focus the textarea — verify a 2px teal outline appears with offset
- Tab to the mode toggle — verify teal outline
- Tab to the submit button — verify teal outline
- Navigate to the results page (submit some text), Tab to filter buttons and search input — verify teal outlines
- NO blue box-shadows should appear on any focused element

**3. Verdict Badges (COMP-01):**
- On the results page in offline mode, check that IOC card header verdict labels show tinted-bg + border + colored-text
- In online mode (if VT API key configured), check that enrichment slot badges also show the same triple pattern with visible borders
- Specifically check the "suspicious" state — it should NOT be solid amber

**4. Filter Bar (COMP-05):**
- On the results page with enough IOCs to scroll, scroll down so content passes behind the sticky filter bar
- Verify the frosted-glass blur effect — content behind the bar should be visibly blurred, not hidden by an opaque background

**5. Buttons (COMP-03):**
- Verify the submit button (primary) is emerald with white text
- Verify the "Back to Input" link (secondary) has zinc background with border
- Verify that disabled buttons show reduced opacity

Resume signal: Type "approved" to mark Phase 12 complete, or describe any visual issues found.
  </action>
  <verify>
    <automated>cd /home/chris/projects/sentinelx && pytest tests/ --ignore=tests/e2e -x -q 2>&1 | tail -3</automated>
  </verify>
  <done>Human has visually verified all five ROADMAP success criteria for Phase 12 and typed "approved".</done>
</task>

</tasks>

<verification>
After both tasks:
1. `app/templates/macros/icons.html` exists and contains icon macro
2. `base.html` imports icon macro and uses brand-accent span
3. `make css` completes without errors
4. `pytest tests/ --ignore=tests/e2e -x -q` passes
5. Human visual verification confirms all 5 success criteria from ROADMAP
</verification>

<success_criteria>
- Icon macro file exists with at least shield-check and cog-6-tooth icons
- base.html imports and uses the icon macro
- Header brand name uses Inter Variable with emerald accent on "Sentinel"
- Footer text updated from Phase 1 placeholder
- Nav link has cog icon
- Human approves visual verification of all Phase 12 components
</success_criteria>

<output>
After completion, create `.planning/phases/12-shared-component-elevation/12-03-SUMMARY.md`
</output>
