---
phase: 11-foundation-design-tokens-base-css
plan: 02
type: execute
wave: 2
depends_on:
  - "11-01"
files_modified:
  - app/static/src/input.css
  - app/static/dist/style.css
autonomous: true
requirements:
  - FOUND-01
  - FOUND-06
  - FOUND-08

must_haves:
  truths:
    - "All CSS custom properties use the zinc/emerald/teal palette — no GitHub blue-gray hex values (#0d1117, #161b22, #1c2128, #30363d, #484f58, #8b949e) remain in :root"
    - "Verdict color triples (text/bg/border) are defined for all five verdict states — malicious, suspicious, clean, no_data, error"
    - "Typography tokens (--font-ui, --font-mono, --weight-heading, --weight-body, --weight-caption, --tracking-heading) exist in :root"
    - "The autofill override block prevents yellow flash on input fields with dark background"
    - "All component rules in @layer components reference var(--token) — no orphaned references to removed token names"
    - "make css builds successfully and dist/style.css is regenerated"
  artifacts:
    - path: "app/static/src/input.css"
      provides: "Complete zinc/emerald/teal design token system, updated component rules, autofill override, typography scale"
      contains: "zinc-950"
    - path: "app/static/dist/style.css"
      provides: "Compiled CSS output with new token values"
  key_links:
    - from: "app/static/src/input.css :root"
      to: "app/static/src/input.css @layer components"
      via: "CSS custom property references (var())"
      pattern: "var\\(--verdict-(malicious|suspicious|clean|no-data|error)-(text|bg|border)\\)"
    - from: "app/static/src/input.css :root"
      to: "app/static/src/input.css @layer base body"
      via: "font-family token references"
      pattern: "var\\(--font-(ui|mono)\\)"
---

<objective>
Rewrite the entire :root token block with the zinc/emerald/teal design system, update all component rules that reference changed token names, add the autofill override CSS, and define the typography scale tokens.

Purpose: This is the core of Phase 11 — transforming the color palette from GitHub blue-gray to the target Linear/Vercel-inspired zinc/emerald/teal system. Every subsequent phase depends on these tokens being correct. The component rule updates ensure no broken references, and the autofill override fixes the settings page API key input.

Output: A fully rewritten input.css with new token values, updated component rules, autofill override, and a successful `make css` build.
</objective>

<execution_context>
@/home/chris/.claude/get-shit-done/workflows/execute-plan.md
@/home/chris/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/11-foundation-design-tokens-base-css/11-RESEARCH.md
@.planning/phases/11-foundation-design-tokens-base-css/11-01-SUMMARY.md
@app/static/src/input.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Rewrite :root token block and typography scale</name>
  <files>app/static/src/input.css</files>
  <action>
Replace the ENTIRE `:root { ... }` block in `input.css` with the new zinc/emerald/teal token system. The @font-face declarations added by Plan 01 must remain above the @tailwind directives — only the `:root` block changes.

**New :root block (replace old one completely):**

```css
:root {
    /* Surfaces — zinc hierarchy */
    --bg-primary:    #09090b;   /* zinc-950 — page base */
    --bg-secondary:  #18181b;   /* zinc-900 — card surface */
    --bg-tertiary:   #27272a;   /* zinc-800 — inputs, nested */
    --bg-hover:      #3f3f46;   /* zinc-700 — hover state */

    /* Borders — opacity-based white */
    --border:        rgba(255, 255, 255, 0.06);   /* subtle */
    --border-default: rgba(255, 255, 255, 0.10);  /* default */
    --border-hover:  rgba(255, 255, 255, 0.18);   /* emphasis */

    /* Text — zinc scale */
    --text-primary:   #f4f4f5;  /* zinc-100 — headings */
    --text-secondary: #a1a1aa;  /* zinc-400 — labels, metadata */
    --text-muted:     #71717a;  /* zinc-500 — placeholder, footnotes */

    /* Accent — emerald/teal */
    --accent:            #10b981;  /* emerald-500 — primary actions */
    --accent-hover:      #34d399;  /* emerald-400 — hover */
    --accent-subtle:     #022c22;  /* emerald-950 — tinted bg */
    --accent-interactive: #14b8a6; /* teal-500 — focus rings */

    /* IOC type accent colors — keep existing high-luminance values, verified against zinc-900 */
    --accent-ipv4:   #4a9eff;
    --accent-ipv6:   #4a9eff;
    --accent-domain: #4aff9e;
    --accent-url:    #4aeeee;
    --accent-md5:    #ff9e4a;
    --accent-sha1:   #ff9e4a;
    --accent-sha256: #ff9e4a;
    --accent-cve:    #ff4a4a;

    /* Verdict color triples (text / bg / border) */
    --verdict-malicious-text:   #f87171;   /* red-400 */
    --verdict-malicious-bg:     #450a0a;   /* red-950 */
    --verdict-malicious-border: #ef4444;   /* red-500 */

    --verdict-suspicious-text:   #fbbf24;  /* amber-400 */
    --verdict-suspicious-bg:     #451a03;  /* amber-950 */
    --verdict-suspicious-border: #f59e0b;  /* amber-500 */

    --verdict-clean-text:   #34d399;       /* emerald-400 */
    --verdict-clean-bg:     #022c22;       /* emerald-950 */
    --verdict-clean-border: #10b981;       /* emerald-500 */

    --verdict-no-data-text:   #a1a1aa;     /* zinc-400 */
    --verdict-no-data-bg:     #27272a;     /* zinc-800 */
    --verdict-no-data-border: #3f3f46;     /* zinc-700 */

    --verdict-error-text:   #fbbf24;       /* reuse amber */
    --verdict-error-bg:     #451a03;
    --verdict-error-border: #f59e0b;

    /* Interactive — now emerald-based */
    --btn-primary-bg:     #10b981;   /* emerald-500 */
    --btn-primary-hover:  #059669;   /* emerald-600 */
    --btn-secondary-bg:   #27272a;   /* zinc-800 */
    --btn-secondary-hover: #3f3f46;  /* zinc-700 */

    /* Typography */
    --font-ui:   'Inter Variable', system-ui, sans-serif;
    --font-mono: 'JetBrains Mono Variable', 'JetBrains Mono', monospace;

    /* Typography scale */
    --weight-heading: 600;
    --weight-body:    400;
    --weight-caption: 500;
    --tracking-heading: -0.02em;
    --line-height-body: 1.6;

    /* Shape */
    --radius:    6px;
    --radius-sm: 4px;

    /* Dark mode signal */
    color-scheme: dark;
}
```

**Key changes from old tokens:**
- Surface colors shift from blue-gray (#0d1117/#161b22/#1c2128) to zinc (#09090b/#18181b/#27272a)
- Added `--bg-hover` (zinc-700) — new token for hover states
- Borders shift from hex (#30363d/#484f58) to opacity-based white rgba
- Added `--border-default` — new token between subtle and emphasis
- `--text-secondary` upgrades from #8b949e to #a1a1aa (zinc-400, passes WCAG AA)
- Added `--text-muted` (zinc-500) — new token for placeholders
- Old single-verdict tokens REMOVED — replaced by verdict triples
- `--font-ui` now starts with 'Inter Variable', `--font-mono` starts with 'JetBrains Mono Variable'
- Added typography scale tokens (weights, tracking, line-height)
- Added accent tokens (emerald/teal)
- `--btn-primary-bg` changes from green (#238636) to emerald (#10b981)
- `color-scheme: dark;` added at end of :root

**DO NOT change:**
- IOC type accent colors (--accent-ipv4 through --accent-cve) — keep existing values
- --radius and --radius-sm values
  </action>
  <verify>
    <automated>grep -c "zinc-950" app/static/src/input.css && grep -c "verdict-malicious-text" app/static/src/input.css && grep -c "weight-heading" app/static/src/input.css && ! grep "#0d1117\|#161b22\|#1c2128\|#8b949e" app/static/src/input.css</automated>
    <manual>:root block contains all zinc/emerald/teal tokens, verdict triples, typography scale, and no old GitHub palette values</manual>
  </verify>
  <done>The :root block contains the complete zinc/emerald/teal token system with verdict triples, typography scale tokens, and zero remaining GitHub palette hex values</done>
</task>

<task type="auto">
  <name>Task 2: Update component rules for new token names and add autofill override</name>
  <files>app/static/src/input.css</files>
  <action>
Update all component rules in `@layer components` that reference old token names. Then add the autofill override CSS. Then run `make css`.

**1. Update verdict-related component rules:**

The old code used single tokens like `var(--verdict-malicious)` and hardcoded `rgba()` values. Update these to use the new triple tokens.

a) `.verdict-label--*` rules (around line 752):
   Replace each verdict label with the triple-token pattern:
   ```css
   .verdict-label--malicious  { background-color: var(--verdict-malicious-bg);  color: var(--verdict-malicious-text); border: 1px solid var(--verdict-malicious-border); }
   .verdict-label--suspicious { background-color: var(--verdict-suspicious-bg); color: var(--verdict-suspicious-text); border: 1px solid var(--verdict-suspicious-border); }
   .verdict-label--clean      { background-color: var(--verdict-clean-bg);      color: var(--verdict-clean-text); border: 1px solid var(--verdict-clean-border); }
   .verdict-label--no_data    { background-color: var(--verdict-no-data-bg);    color: var(--verdict-no-data-text); border: 1px solid var(--verdict-no-data-border); }
   .verdict-label--error      { background-color: var(--verdict-error-bg);      color: var(--verdict-error-text); border: 1px solid var(--verdict-error-border); }
   ```
   IMPORTANT: This fixes the suspicious badge outlier — it now uses tinted-bg instead of solid `#f59e0b` with black text. (Note: This is a partial fix at the token level; COMP-01 in Phase 12 completes it.)

b) `.verdict-badge` rules (`.verdict-malicious`, `.verdict-suspicious`, etc., around line 870):
   Same triple-token pattern:
   ```css
   .verdict-malicious  { background-color: var(--verdict-malicious-bg);  color: var(--verdict-malicious-text); }
   .verdict-suspicious { background-color: var(--verdict-suspicious-bg); color: var(--verdict-suspicious-text); }
   .verdict-clean      { background-color: var(--verdict-clean-bg);      color: var(--verdict-clean-text); }
   .verdict-no_data    { background-color: var(--verdict-no-data-bg);    color: var(--verdict-no-data-text); }
   .verdict-error      { background-color: var(--verdict-error-bg);      color: var(--verdict-error-text); }
   ```

c) `.verdict-dashboard-badge[data-verdict="*"]` rules (around line 482):
   Replace hardcoded rgba values with token references:
   ```css
   .verdict-dashboard-badge[data-verdict="malicious"] {
       background-color: var(--verdict-malicious-bg);
       border-color: var(--verdict-malicious-border);
       color: var(--verdict-malicious-text);
   }
   .verdict-dashboard-badge[data-verdict="suspicious"] {
       background-color: var(--verdict-suspicious-bg);
       border-color: var(--verdict-suspicious-border);
       color: var(--verdict-suspicious-text);
   }
   .verdict-dashboard-badge[data-verdict="clean"] {
       background-color: var(--verdict-clean-bg);
       border-color: var(--verdict-clean-border);
       color: var(--verdict-clean-text);
   }
   .verdict-dashboard-badge[data-verdict="no_data"] {
       background-color: var(--verdict-no-data-bg);
       border-color: var(--verdict-no-data-border);
       color: var(--verdict-no-data-text);
   }
   ```

d) `.ioc-card[data-verdict="*"]` border-left rules (around line 686):
   Update to use the `-border` triple token:
   ```css
   .ioc-card[data-verdict="malicious"]  { border-left-color: var(--verdict-malicious-border); }
   .ioc-card[data-verdict="suspicious"] { border-left-color: var(--verdict-suspicious-border); }
   .ioc-card[data-verdict="clean"]      { border-left-color: var(--verdict-clean-border); }
   .ioc-card[data-verdict="no_data"]    { border-left-color: var(--verdict-no-data-border); }
   .ioc-card[data-verdict="error"]      { border-left-color: var(--verdict-error-border); }
   ```

e) `.filter-btn--*.filter-btn--active` rules (around line 563):
   Update to use verdict tokens:
   ```css
   .filter-btn--malicious.filter-btn--active {
       border-color: var(--verdict-malicious-border);
       color: var(--verdict-malicious-text);
       background-color: var(--verdict-malicious-bg);
   }
   .filter-btn--suspicious.filter-btn--active {
       border-color: var(--verdict-suspicious-border);
       color: var(--verdict-suspicious-text);
       background-color: var(--verdict-suspicious-bg);
   }
   .filter-btn--clean.filter-btn--active {
       border-color: var(--verdict-clean-border);
       color: var(--verdict-clean-text);
       background-color: var(--verdict-clean-bg);
   }
   .filter-btn--no_data.filter-btn--active {
       border-color: var(--verdict-no-data-border);
       color: var(--verdict-no-data-text);
       background-color: var(--verdict-no-data-bg);
   }
   ```

**2. Update textarea placeholder to use --text-muted:**
   ```css
   .ioc-textarea::placeholder {
       color: var(--text-muted);
       opacity: 1;
   }
   ```
   (Change opacity from 0.6 to 1 since --text-muted is already the correct muted value.)

   Also update `.filter-search-input::placeholder`:
   ```css
   .filter-search-input::placeholder {
       color: var(--text-muted);
       opacity: 1;
   }
   ```

**3. Add autofill override CSS — place at the END of the `@layer components` block, before the closing `}`:**

```css
    /* ---- Autofill override for dark inputs ---- */

    input:-webkit-autofill,
    input:-webkit-autofill:hover,
    input:-webkit-autofill:focus,
    input:-webkit-autofill:active {
        -webkit-box-shadow: 0 0 0 100px var(--bg-tertiary) inset !important;
        box-shadow:         0 0 0 100px var(--bg-tertiary) inset !important;
        -webkit-text-fill-color: var(--text-primary) !important;
        transition: background-color 5000s ease-in-out 0s;
    }
```

**4. Run `make css` to rebuild dist/style.css.**

**5. Run `pytest tests/ -x -q --timeout=30` to confirm no regressions.**

**6. Verify no orphaned token references:**
   ```bash
   grep -n "var(--verdict-malicious)" app/static/src/input.css
   grep -n "var(--verdict-suspicious)" app/static/src/input.css
   grep -n "var(--verdict-clean)" app/static/src/input.css
   grep -n "var(--verdict-no-data)" app/static/src/input.css
   grep -n "var(--verdict-error)" app/static/src/input.css
   ```
   None of these old single-token names should appear anywhere in the file. All references must now use the `-text`, `-bg`, or `-border` suffixed versions.

**IMPORTANT — DO NOT:**
- Change ANY class names (no BEM rename, no HTML changes)
- Touch any template files
- Add or remove CSS rules (only modify existing rule values)
- Change the safelist in tailwind.config.js
- Modify main.js
  </action>
  <verify>
    <automated>make css 2>&1 | tail -3 && ! grep "var(--verdict-malicious)" app/static/src/input.css | grep -v "\-text\|\-bg\|\-border" && grep -c "webkit-autofill" app/static/src/input.css && pytest tests/ -x -q --timeout=30 2>&1 | tail -5</automated>
    <manual>All verdict component rules reference triple tokens, autofill override block exists, no orphaned single-name verdict token references, make css succeeds, tests pass</manual>
  </verify>
  <done>All component rules updated to use verdict triple tokens, placeholder color uses --text-muted, autofill override CSS in place, make css builds successfully, all tests pass, no orphaned old token references remain</done>
</task>

</tasks>

<verification>
1. The :root block contains the complete zinc/emerald/teal token set with no old GitHub palette values
2. All verdict-related component rules use triple tokens (--verdict-*-text, --verdict-*-bg, --verdict-*-border)
3. No orphaned references to old single-name verdict tokens (--verdict-malicious, etc. without suffix)
4. Typography scale tokens (--weight-heading, --weight-body, --weight-caption, --tracking-heading, --line-height-body) defined
5. --font-ui references Inter Variable, --font-mono references JetBrains Mono Variable
6. Autofill override CSS block present with box-shadow inset trick
7. `make css` succeeds
8. All existing pytest tests pass
9. `grep` for #0d1117, #161b22, #1c2128, #8b949e in :root returns zero matches
</verification>

<success_criteria>
- Complete zinc/emerald/teal design token system in :root
- All component rules consistently use the new token names (no broken references)
- Autofill override prevents yellow flash on dark inputs
- Typography scale tokens enable consistent weight/tracking/line-height usage
- Build succeeds, tests pass, no visual regressions
</success_criteria>

<output>
After completion, create `.planning/phases/11-foundation-design-tokens-base-css/11-02-SUMMARY.md`
</output>
